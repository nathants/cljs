#!/usr/bin/env python2.7
import sys
import re
import edn_format

filepath = sys.argv[1]
mode = sys.argv[2]

with open(filepath) as f:
    lines = f.read().splitlines()
lines = [re.sub('#_', '', line) for line in lines]
for i in range(10000):
    i += 1
    try:
        ns = edn_format.loads('\n'.join(lines[:i]))
        break
    except:
        pass
else:
    assert False, 'failed to parse ns'
for xs in ns[2:]:
    name = getattr(xs[0], 'name', '')
    if mode == 'source':
        print '\n'.join(lines[i:])
        break
    elif mode == name:
        for y in xs[1:]:
            print edn_format.dumps(y)
        break
